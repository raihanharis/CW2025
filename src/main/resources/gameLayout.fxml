<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.Group?>
<?import com.comp2042.GameOverPanel?>
<?import java.net.URL?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.Text?>

<!-- Root: StackPane for overlays -->
<StackPane fx:id="rootPane"
           fx:controller="com.comp2042.GuiController"
           xmlns:fx="http://javafx.com/fxml"
           style="-fx-background-color: linear-gradient(to bottom, #0a0a1a, #000000);">

    <!-- Centered Container - Wraps all three panels -->
    <HBox alignment="CENTER" 
          HBox.hgrow="ALWAYS"
          style="-fx-background-color: transparent;">
        
        <!-- Main game layout - All three panels -->
        <HBox fx:id="gameContainer" 
              alignment="TOP_CENTER" 
              spacing="40"
              style="-fx-background-color: transparent;">
        
        <!-- LEFT SIDEBAR - Two Independent Boxes -->
        <VBox fx:id="leftPanel" 
              alignment="TOP_CENTER" 
              spacing="16"
              style="-fx-background-color: transparent; -fx-padding: 0; -fx-min-width: 160; -fx-pref-width: 160; -fx-max-width: 160;">
            
            <!-- BOX 1: MAIN INFO PANEL -->
            <VBox alignment="TOP_CENTER" 
                  spacing="18"
                  styleClass="main-info-box"
                  VBox.vgrow="NEVER">
                
                <!-- TETRIS Logo (Top) -->
                <Label text="TETRIS" style="-fx-text-fill: #00d4ff; -fx-font-size: 24; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, #00d4ff, 10, 0.5, 0, 0);"/>
                
                <!-- SCORE Section -->
                <VBox alignment="CENTER" spacing="6" styleClass="stat-panel score-panel">
                    <Label text="SCORE" styleClass="stat-title"/>
                    <Label fx:id="scoreLabel" text="0" styleClass="scoreValue"/>
                </VBox>
                
                <!-- LEVEL Section -->
                <VBox alignment="CENTER" spacing="6" styleClass="stat-panel level-panel">
                    <Label text="LEVEL" styleClass="stat-title"/>
                    <Label fx:id="levelLabel" text="1" styleClass="levelValue"/>
                </VBox>
                
                <!-- LINES Section -->
                <VBox alignment="CENTER" spacing="6" styleClass="stat-panel lines-panel">
                    <Label text="LINES" styleClass="stat-title"/>
                    <Label fx:id="linesLabel" text="0" styleClass="linesValue"/>
                </VBox>
                
                <!-- HIGH SCORE Section -->
                <VBox alignment="CENTER" spacing="6" styleClass="stat-panel score-panel">
                    <Label text="HIGH SCORE" styleClass="stat-title"/>
                    <Label fx:id="highScoreValue" text="0" styleClass="scoreValue"/>
                </VBox>
                
                <!-- Restart Button -->
                <Button fx:id="restartButton" 
                        text="⟳ RESTART"
                        onAction="#onRestartClick"
                        styleClass="game-button restart-button"/>
                
                <!-- Pause Button -->
                <Button fx:id="pauseButton"
                        text="⏸ PAUSE"
                        onAction="#onPauseClick"
                        styleClass="game-button pause-resume-button"/>
            </VBox>
            
            <!-- BOX 2: CONTROLS PANEL -->
            <VBox alignment="TOP_CENTER" 
                  spacing="8"
                  styleClass="controls-panel-box"
                  VBox.vgrow="NEVER">
                
                <!-- CONTROLS Title -->
                <Label text="CONTROLS" styleClass="controls-title"/>
                
                <!-- Control Instructions -->
                <Label text="← →  Move" styleClass="control-text"/>
                <Label text="↑    Rotate" styleClass="control-text"/>
                <Label text="↓    Soft Drop" styleClass="control-text"/>
                <Label text="SPACE Hard Drop" styleClass="control-text"/>
                <Label text="P    Pause" styleClass="control-text"/>
            </VBox>
        </VBox>
        
        <!-- CENTER: Game Board Container -->
        <VBox alignment="TOP_CENTER" 
              styleClass="playfield-container"
              HBox.hgrow="NEVER">
            <!-- StackPane to overlay GameOverPanel on top of board -->
            <StackPane fx:id="gameBoardStackPane" alignment="CENTER">
                <GridPane fx:id="gamePanel" 
                          hgap="1" 
                          vgap="1"
                          styleClass="playfield-grid"/>
                <!-- Game Over Overlay - Centered relative to board only -->
                <GameOverPanel fx:id="gameOverPanel" visible="false"/>
            </StackPane>
        </VBox>

        <!-- RIGHT: Next Preview Panel -->
        <VBox fx:id="nextPanel" 
              alignment="TOP_CENTER" 
              spacing="12"
              style="-fx-padding: 0; -fx-min-width: 100; -fx-pref-width: 100; -fx-max-width: 100;">
            
            <!-- NEXT 1 Label - Above the first frame (center-aligned) -->
            <Label fx:id="nextLabel" 
                   text="NEXT 1" 
                   styleClass="next-title"/>
            
            <!-- First Preview Box - Next brick (centered) -->
            <VBox fx:id="nextPreviewFrame"
                  alignment="CENTER"
                  styleClass="next-box">
                <GridPane fx:id="brickPanel" 
                          hgap="1" 
                          vgap="1"
                          alignment="CENTER"/>
            </VBox>
            
            <!-- NEXT 2 Label - Above the second frame (center-aligned) -->
            <Label fx:id="upNextLabel" 
                   text="NEXT 2" 
                   styleClass="next-title"/>
            
            <!-- Second Preview Box - Next 2 brick (centered) -->
            <VBox fx:id="nextPreviewFrame2"
                  alignment="CENTER"
                  styleClass="next-box">
                <GridPane fx:id="brickPanel2" 
                          hgap="1" 
                          vgap="1"
                          alignment="CENTER"/>
            </VBox>
            
            <!-- Notification group stays outside the frames -->
            <Group fx:id="groupNotification"/>
        </VBox>
        </HBox>
    </HBox>

    <!-- Pause Overlay -->
    <VBox fx:id="pauseOverlay" 
          visible="false" 
          alignment="CENTER" 
          style="-fx-background-color: rgba(0, 0, 0, 0.75);">
        <Label fx:id="pauseLabel" 
               text="PRESS P TO RESUME" 
               style="-fx-font-size: 42; -fx-font-weight: bold; -fx-text-fill: white; -fx-font-family: 'Arial Black';"/>
    </VBox>

    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
</StackPane>
