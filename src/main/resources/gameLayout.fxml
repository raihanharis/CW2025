<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.Group?>
<?import com.comp2042.GameOverPanel?>
<?import java.net.URL?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.Text?>

<!-- Root: StackPane for overlays -->
<StackPane fx:id="rootPane"
           fx:controller="com.comp2042.GuiController"
           xmlns:fx="http://javafx.com/fxml"
           style="-fx-background-color: #0a0a0a;">

    <!-- Main game layout -->
    <HBox fx:id="gameContainer" alignment="CENTER" spacing="20">
        
        <!-- LEFT SIDEBAR - Control Panel (Official Tetris Style) -->
        <VBox fx:id="leftPanel" 
              alignment="TOP_CENTER" 
              spacing="14"
              style="-fx-background-color: linear-gradient(to bottom, #1a1a2e, #0d0d1a); -fx-padding: 20 15; -fx-background-radius: 10; -fx-min-width: 130;">
            
            <!-- Title -->
            <Label text="TETRIS" style="-fx-text-fill: #00d4ff; -fx-font-size: 24; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, #00d4ff, 10, 0.5, 0, 0);"/>
            
            <!-- Separator -->
            <Separator style="-fx-padding: 5 0;"/>
            
            <!-- SCORE Section -->
            <VBox alignment="CENTER" spacing="6" styleClass="stat-panel score-panel">
                <Label text="SCORE" styleClass="stat-title"/>
                <Label fx:id="scoreLabel" text="0" styleClass="scoreValue"/>
            </VBox>
            
            <!-- LEVEL Section -->
            <VBox alignment="CENTER" spacing="6" styleClass="stat-panel level-panel">
                <Label text="LEVEL" styleClass="stat-title"/>
                <Label fx:id="levelLabel" text="1" styleClass="levelValue"/>
            </VBox>
            
            <!-- LINES Section -->
            <VBox alignment="CENTER" spacing="6" styleClass="stat-panel lines-panel">
                <Label text="LINES" styleClass="stat-title"/>
                <Label fx:id="linesLabel" text="0" styleClass="linesValue"/>
            </VBox>
            
            <!-- Spacer -->
            <Region VBox.vgrow="ALWAYS"/>
            
            <!-- Buttons Section -->
            <VBox alignment="CENTER" spacing="20">
                <Button fx:id="restartButton" 
                        text="⟳ RESTART"
                        onAction="#onRestartClick"
                        prefWidth="120"
                        styleClass="game-button restart-button"/>
                
                <Button fx:id="pauseButton"
                        text="⏸ PAUSE"
                        onAction="#onPauseClick"
                        prefWidth="120"
                        styleClass="game-button pause-resume-button"/>
            </VBox>
            
            <!-- Controls Help -->
            <VBox alignment="CENTER" spacing="3" style="-fx-padding: 15 0 0 0;">
                <Label text="─── CONTROLS ───" style="-fx-text-fill: #555555; -fx-font-size: 9;"/>
                <Label text="← →  Move" style="-fx-text-fill: #666666; -fx-font-size: 10;"/>
                <Label text="↑    Rotate" style="-fx-text-fill: #666666; -fx-font-size: 10;"/>
                <Label text="↓    Soft Drop" style="-fx-text-fill: #666666; -fx-font-size: 10;"/>
                <Label text="SPACE Hard Drop" style="-fx-text-fill: #666666; -fx-font-size: 10;"/>
                <Label text="P    Pause" style="-fx-text-fill: #666666; -fx-font-size: 10;"/>
            </VBox>
        </VBox>
        
        <!-- CENTER: Game Board -->
        <GridPane fx:id="gamePanel" hgap="1" vgap="1"/>

        <!-- RIGHT: Next Preview Panel -->
        <VBox fx:id="nextPanel" 
              alignment="TOP_CENTER" 
              spacing="12"
              style="-fx-padding: 10;">
            
            <!-- NEXT Label - Above the frame -->
            <Label fx:id="nextLabel" 
                   text="NEXT" 
                   style="-fx-text-fill: #cccccc; -fx-font-size: 14; -fx-font-weight: bold;"/>
            
            <!-- Compact Preview Frame - Only wraps the block grid -->
            <VBox fx:id="nextPreviewFrame"
                  alignment="CENTER"
                  styleClass="next-preview-frame">
                <GridPane fx:id="brickPanel" 
                          hgap="1" 
                          vgap="1"
                          alignment="CENTER"
                          maxWidth="Infinity"
                          maxHeight="Infinity"/>
            </VBox>
            
            <!-- Notification group stays outside the frame -->
            <Group fx:id="groupNotification"/>
        </VBox>
    </HBox>

    <!-- Pause Overlay -->
    <VBox fx:id="pauseOverlay" 
          visible="false" 
          alignment="CENTER" 
          style="-fx-background-color: rgba(0, 0, 0, 0.75);">
        <Label fx:id="pauseLabel" 
               text="PRESS P TO RESUME" 
               style="-fx-font-size: 42; -fx-font-weight: bold; -fx-text-fill: white; -fx-font-family: 'Arial Black';"/>
    </VBox>

    <!-- Game Over Overlay -->
    <GameOverPanel fx:id="gameOverPanel" visible="false"/>

    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
</StackPane>
